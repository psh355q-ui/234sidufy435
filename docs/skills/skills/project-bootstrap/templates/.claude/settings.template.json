{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "_comment": "Claude Code 설정 템플릿 - 프로젝트에 맞게 수정하세요",

  "hooks": {
    "PostToolUse": [
      {
        "_comment": "파일 수정 후 자동 포맷팅 (CI 포맷 에러 방지)",
        "matcher": "Edit|Write",
        "command": "if [[ {{filePath}} == *.py ]]; then ruff format {{filePath}}; elif [[ {{filePath}} == *.ts* || {{filePath}} == *.tsx ]]; then npx prettier --write {{filePath}}; fi"
      },
      {
        "_comment": "테스트 완료 시 사운드 알림 (macOS)",
        "_comment2": "성공: Glass + TTS / 실패: Basso + TTS",
        "matcher": "Bash",
        "command": "if echo '{{output}}' | grep -qE 'passed|PASSED|✅.*GREEN'; then afplay /System/Library/Sounds/Glass.aiff 2>/dev/null && say 'Tests passed' 2>/dev/null; elif echo '{{output}}' | grep -qE 'failed|FAILED|❌|ERROR'; then afplay /System/Library/Sounds/Basso.aiff 2>/dev/null && say 'Tests failed' 2>/dev/null; fi"
      }
    ]
  },

  "permissions": {
    "_comment_allow": "자동 승인되는 안전한 명령어",
    "allow": [
      "npm run build",
      "npm run test",
      "npm run test:watch",
      "npm run lint",
      "npm run lint:fix",
      "npm run dev",
      "npm run type-check",
      "npm install",
      "npx prettier",
      "npx vitest",
      "npx playwright test",

      "pytest",
      "pytest --cov",
      "pytest -v",
      "ruff check",
      "ruff format",
      "mypy",
      "uvicorn",
      "alembic upgrade head",
      "alembic revision",

      "git status",
      "git log",
      "git diff",
      "git branch",
      "git worktree list",
      "git worktree add",
      "git worktree remove",

      "docker ps",
      "docker logs",
      "docker compose up -d",
      "docker compose down"
    ],

    "_comment_deny": "절대 자동 실행되지 않는 위험한 명령어",
    "deny": [
      "rm -rf",
      "rm -r /",
      "git push --force",
      "git push -f",
      "git reset --hard",
      "git clean -fd",
      "DROP TABLE",
      "DROP DATABASE",
      "DELETE FROM",
      "TRUNCATE",
      "chmod 777",
      "curl | sh",
      "wget | sh"
    ]
  },

  "_usage": {
    "instructions": [
      "1. 이 파일을 프로젝트의 .claude/settings.json으로 복사",
      "2. 프로젝트에 맞게 hooks.PostToolUse.command 수정",
      "3. 필요한 명령어를 permissions.allow에 추가",
      "4. Claude Code 재시작"
    ],
    "notes": [
      "- _comment로 시작하는 키는 문서용이며 무시됨",
      "- Git merge/commit은 사용자 승인 필수 (allow에 추가 금지)",
      "- 파일 삭제 명령어는 deny에 유지 권장"
    ]
  }
}
